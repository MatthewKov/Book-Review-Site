<DOCTYPE html>
<!-- Contributions by Louisa Evola and Matthew Kovalenko-->
<html>
	<head>
		<meta charset="utf-8">
  		<meta name="viewport" content="width=device-width, initial-scale=1">
  		<title>Website name</title>
  		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />
  		<script src="https://kit.fontawesome.com/595acf0be0.js" crossorigin="anonymous"></script>
  		<link rel="stylesheet" href="prof-style.css">

	</head>

	<body>
		<header>
			<div id="nav-placeholder"></div>
		</header>

		<div id="person-info">
			<div id=user>
				<img id="profile-pic" src="profile-pic.png" alt="" width="100" height="100">
				<label for="profile-pic">louisaevola100</label>
			</div>
			<div id="bio">
				<p id="bio-txt" >4th year student at UVA. Avid reader looking to branch out to new genres. </[span]>
			</div>
		</div>

		<div id="bookshelf" class="flex-container">
			<div class="flex-child">
				<h4>Books I've read</h4>
				<ul id="books-read">
				</ul>
				<input id="title_read" type="text" placeholder="Add a book"> & <input id="author_read" type="text" placeholder="Add author">
				<button id="add_read" class="btn btn-primary" onclick="addBookRead()">Add to list</button>
				<div><span class="error_message" id="err_read"></span></div>
			</div>
			<div class="flex-child">
				<h4>Books I want to read</h4>
				<ul id="books-to-read">
				</ul>
				<input id="title_to_read" type="text" placeholder="Add a book"> & <input id="author_to_read" type="text" placeholder="Add author">
				<button id="add_to_read" class="btn btn-primary" onclick="addBookToRead()">Add to list</button>
				<div><span class="error_message" id="err_to_read"></span></div>
			</div>
		</div>
		<script>
	  		$(function(){
  				$("#nav-placeholder").load("navbar.html");
			});

			var profile = {
				readList: [],
				toReadList: []
			};

			function addBookRead() {
				var title = document.getElementById("title_read").value;
				var author = document.getElementById("author_read").value;
				if(title !== "" && author !== "") {
					if(checkBookExists(author, title, profile.readList)) {
						document.getElementById("err_read").innerHTML = "This list already contains that book";
					}
					else {
						document.getElementById("err_read").innerHTML = "";
						var list = document.getElementById("books-read");
						var newBook = document.createElement("li");
						newBook.appendChild(document.createTextNode(title + " by " + author));
						newBook.setAttribute("id", title + "-" + author);
						var delButton = document.createElement("input");
						delButton.setAttribute("type", "button");
						delButton.setAttribute("value", "Remove");
						delButton.setAttribute("onclick", "deleteBook()");
						delButton.onclick = deleteBook.bind(this, [author, title, "readList"]);
						newBook.appendChild(delButton);
						list.appendChild(newBook);
						profile.readList.push({
							author: author,
							title: title
						});
						console.log(profile.readList);
					}
				}
				else {
					document.getElementById("err_read").innerHTML = "Error: missing field(s)";
				}
			}

			function addBookToRead() {
				var title = document.getElementById("title_to_read").value;
				var author = document.getElementById("author_to_read").value;
				if(title !== "" && author !== "") {
					if(checkBookExists(author, title, profile.toReadList)) {
						document.getElementById("err_to_read").innerHTML = "This list already contains that book";
					}
					else {
						var list = document.getElementById("books-to-read");
						var newBook = document.createElement("li");
						newBook.appendChild(document.createTextNode(title + " by " + author));
						newBook.setAttribute("id", title + "-" + author);
						var delButton = document.createElement("input");
						delButton.setAttribute("type", "button");
						delButton.setAttribute("value", "Remove");
						delButton.setAttribute("onclick", "deleteBook()");
						delButton.onclick = deleteBook.bind(this, [author, title, "toReadList"]);
						newBook.appendChild(delButton);
						list.appendChild(newBook);
						profile.toReadList.push({
							author: author,
							title: title
						});
						console.log(profile.toReadList);
					}
				}
				else {
					document.getElementById("err_to_read").innerHTML = "Error: missing field(s)";
				}
			}

			function checkBookExists(author, title, list) {
				for(var i = 0; i < list.length; i++) {
					if(list[i].author.toLowerCase() == author.toLowerCase() && list[i].title.toLowerCase() == title.toLowerCase()) {
						return true;
					}
				}
				return false;
			}

			/*
			* args[0] = author
			* args[1] = title
			* args[2] = string designating which list to update
			*/
			function deleteBook(args) {
				if(args[2] === "readList") {
					profile.readList = profile.readList.filter((book) => { return book.author != args[0] && book.title != args[1]});
					var list = document.getElementById("books-read")
					var delID = args[1] + "-" + args[0];
					var delNode = document.getElementById(delID);
					list.removeChild(delNode);
					console.log(profile.readList);
				}
				else if(args[2] === "toReadList") {
					profile.toReadList = profile.toReadList.filter((book) => { return book.author != args[0] && book.title != args[1]});
					var list = document.getElementById("books-to-read")
					var delID = args[1] + "-" + args[0];
					var delNode = document.getElementById(delID);
					list.removeChild(delNode);
					console.log(profile.toReadList);
				}
			}

  		</script>
	</body>
		
</html>