<!DOCTYPE html>
<!-- Contributions by Louisa Evola and Matthew Kovalenko-->
<html>
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>BookKeeper</title>

      
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />
      <script src="https://kit.fontawesome.com/595acf0be0.js" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="prof-style.css">

  </head>

  <body>
    <header>
      <div id="nav-placeholder"></div>
    </header>
    <div id="person-info">
      <form action="profile.php" name="bio_form" method="post">
        <div id=user>
          <img id="profile-pic" src="profile-pic.png" alt="" width="100" height="100">
          <label for="profile-pic"><?php echo $_SESSION['user'] ?></label>
        </div>
        <div id="bio" contenteditable="true" onkeyup="updateBio()"><?php echo $profile_list['bio']; ?></div>
        <div>
          <!-- The ajax link is preventing this button from centering -->
          <button type="submit" name="update_bio" class="btn btn-secondary center">Update</button>
          <input type="hidden" id="bio_hidden" name="bio_hidden">
        </div>
      </form>
    </div>

    <div id="bookshelf" class="flex-container">
      <div class="flex-child">
        <form action="profile.php" name="read_form" method="post">
          <h4>Books I've read</h4>
          <ul id="books_read">
            <?php
              foreach($books_read_list as $book) {
                $name = "read_" . $book['title'] . "_" . $book['author'];
                echo '<li>' . $book['title'] . ' by ' . $book['author'] .
                  '<button type="submit" name="read_remove" value="' . $name . '" class="btn btn-secondary">Remove</button>
                  </li>';
              }
            ?>
          </ul>
          <input id="title_read" name="title_read" type="text" placeholder="Add a book"> & <input id="author_read" name="author_read" type="text" placeholder="Add author">
          <button id="add_read" name="add_read" class="btn btn-primary" type="submit">Add to list</button>
          <div><span class="error_message" id="err_read"><?php echo $_POST['err_read'] ?></span></div>
        </form>
      </div>
      <div class="flex-child">
        <h4>Books I want to read</h4>
        <form action="profile.php" method="post">
          <ul id="books_to_read">
            <?php
              foreach($books_to_read_list as $book) {
                $name = "to_read_" . $book['title'] . "_" . $book['author'];
                echo '<li>' . $book['title'] . ' by ' . $book['author'] .
                  '<button type="submit" name="to_read_remove" value="' . $name . '" class="btn btn-secondary">Remove</button>
                  </li>';
              }
            ?>
          </ul>
        </form>
        <form action="profile.php" name="to_read_form" method="post">
          <input id="title_to_read" name="title_to_read" type="text" placeholder="Add a book"> & <input id="author_to_read" name="author_to_read" type="text" placeholder="Add author">
          <button id="add_to_read" name="add_to_read" class="btn btn-primary" type="submit">Add to list</button>
          <div><span class="error_message" id="err_to_read"><?php echo $_POST['err_to_read'] ?></span></div>
        </form>
      </div>
    </div>

    
    <script>
        $(function(){
          $("#nav-placeholder").load("navbar.php");
      });

      function updateBio() {
        //bug clears bio when hit without changing anything
        var bio = document.getElementById('bio').innerHTML;
        var hidden = document.getElementById('bio_hidden');
        hidden.value = bio;
        }
      </script>
  </body>
    
</html>